<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Buscador de Placas 102</title>
  <link rel="manifest" href="manifest.json">
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; display: none; background-color: #f9f9f9; }
    input, button { padding: 10px; margin: 5px; font-size: 16px; }
    button { cursor: pointer; }
    .resultado { margin-top: 15px; font-weight: bold; font-size: 18px; }
    .verde { color: green; }
    .amarillo { color: orange; }
    .rojo { color: red; }
    #chat-container { margin-top: 30px; }
    #chat-mensajes { margin-top: 10px; border-top: 1px solid #ccc; padding-top: 10px; }
    .mensaje { background-color: #eee; padding: 8px; border-radius: 5px; margin-bottom: 5px; }
  </style>
</head>
<body>
  <h1>Buscador de Placas 102</h1>

  <input type="text" id="inputPlaca" placeholder="Ingresa una placa">
  <button onclick="buscarPlaca()">Buscar</button>
  <button onclick="borrarInput()">Borrar</button>
  <div id="resultado"></div>

  <div id="chat-container">
    <h3>¿Falta una placa?</h3>
    <input type="text" id="placaFaltante" placeholder="Escribe la placa faltante">
    <button onclick="enviarPlaca()">Enviar</button>
    <div id="chat-mensajes"></div>
  </div>

  <script>
    const CONTRASEÑA = "clave102";

    const placasTemporales = ["YKJ7867", "YFU725A", "YGG477B", "YMS324B", "YME457A", 
      "YED397B", "XZW243A", "YRR356B", "YJL8749", "YE3792A", "XS5145A", "SY59773"];

    const placas = [
      "YHU362B", "XWA932A", "YEF857A", "YEG462B", "YEB715B", "YGY624B", "YGG842A", "YHX988B", 
      "YHE619B", "YGU546B", "YJR684B", "YKR958A", "YKT887A", "YJY944A", "YLU143A", "YLS123A", 
      "YMC612A", "YMK943A", "YMU690A", "YMR208A", "YNS254A", "YNE119A", "YNN848A", "YNW921A",
      "YNU359A", "YNT814A", "YNK427A", "YPC824A", "YPB832A", "YPH539A", "YQG424A", "YQQ872A",
      "YQT982A", "YQM312A", "YRS626A", "YRV763A", "YRL690A", "YRG982A", "YRR642A", "YRP663A",
      "YSL508A", "YSR979A", "YSY924A", "YSC351A", "YTC804A", "YTW872A", "YTT904A", "YTS834A",
      "YUC186A", "YUF469A", "YUV801A", "YUM539A", "YVL398A", "YVB772A", "YVE744A", "YVP682A",
      "YWP942A", "YWT783A", "YWE768A", "YWY982A", "YXL113A", "YXN568A", "YXQ427A", "YXM284A",
      "YXU972A", "YXT812A", "YXE659A", "YYU248A", "YYR278A", "YYK209A", "YYF821A", "YYL912A",
      "YZY589A", "YZQ216A", "YZR118A", "YZK204A", "ZAD445A", "ZAE706A", "ZAS343A", "ZAZ667A",
      "ZAE706A", "ZBL474A", "ZBN681A", "ZBV801A", "ZBW286A", "ZCG967A", "ZCJ927A", "ZCH157A",
      "ZCU636A", "ZCV364A", "ZCY744A", "ZDH402A", "ZDF252A", "ZDR114A", "ZEA351A", "ZEX234A",
      "ZFS642A", "ZFP902A", "ZGE478A", "ZGC236A", "ZHC235A", "ZHZ376A", "ZHX347A", "ZJD716A",
      "ZJP789A", "ZJR786A", "ZJN627A", "ZJU435A", "ZKD972A", "ZKV745A", "ZKY162A", "ZLH736A",
      "ZLL292A", "ZMC283A", "ZMC979A", "ZMV358A", "ZNC372A", "ZNZ768A", "ZNZ624A", "ZPM343A",
      "ZPH214A", "ZPJ744A", "ZPW206A", "ZPY681A", "ZQF158A", "ZQZ448A", "ZQQ706A", "ZRF382A",
      "ZRV425A", "ZRM553A", "ZRL298A", "ZSK931A", "ZSA414A", "ZSC479A", "ZSM846A", "ZSU161A",
      "ZST291A", "ZTA851A", "ZTU498A", "ZTT134A", "ZTN834A", "ZUE803A", "ZUU253A", "ZUF293A",
      "ZVG306A", "ZVB783A", "ZVC637A", "ZVR752A", "ZVQ492A", "ZVU374A", "ZWJ443A", "ZWT659A",
      "ZWP508A", "ZWC219A", "ZWR514A", "ZWT865A", "ZXJ646A", "ZXA819A", "ZXC292A", "ZXS785A",
      "ZXY175A", "ZYF394A", "ZYE498A", "ZYP364A", "ZYR319A", "ZYZ801A"
    ];

    function verificarAcceso() {
      const accesoConcedido = localStorage.getItem('acceso102');
      if (accesoConcedido === 'true') {
        document.body.style.display = 'block';
        mostrarChat();
      } else {
        const intento = prompt("Introduce la contraseña para acceder:");
        if (intento === CONTRASEÑA) {
          localStorage.setItem('acceso102', 'true');
          document.body.style.display = 'block';
          mostrarChat();
        } else {
          alert("Contraseña incorrecta. Acceso denegado.");
          document.body.innerHTML = "<h2>Acceso denegado</h2>";
        }
      }
    }

    function buscarPlaca() {
      const placa = document.getElementById('inputPlaca').value.trim().toUpperCase();
      const resultado = document.getElementById('resultado');

      if (placas.includes(placa)) {
        resultado.textContent = "La placa " + placa + " es 102 ✅";
        resultado.className = "resultado verde";
      } else if (placasTemporales.includes(placa)) {
        resultado.textContent = "La placa " + placa + " es 102 temporal 🕒";
        resultado.className = "resultado amarillo";
      } else {
        resultado.textContent = "La placa " + placa + " es 101 ❌";
        resultado.className = "resultado rojo";
      }
    }

    function borrarInput() {
      document.getElementById('inputPlaca').value = '';
      document.getElementById('resultado').textContent = '';
    }

    function enviarPlaca() {
      const nuevaPlaca = document.getElementById('placaFaltante').value.trim().toUpperCase();
      if (nuevaPlaca === '') return;

      let placasFaltantes = JSON.parse(localStorage.getItem('placasFaltantes') || '[]');

      if (!placasFaltantes.includes(nuevaPlaca)) {
        placasFaltantes.push(nuevaPlaca);
        localStorage.setItem('placasFaltantes', JSON.stringify(placasFaltantes));
        mostrarChat();
        document.getElementById('placaFaltante').value = '';
      }
    }

    function mostrarChat() {
      const contenedor = document.getElementById('chat-mensajes');
      contenedor.innerHTML = '';
      const placasFaltantes = JSON.parse(localStorage.getItem('placasFaltantes') || '[]');

      placasFaltantes.forEach(placa => {
        const div = document.createElement('div');
        div.className = 'mensaje';
        div.textContent = `Placa sugerida: ${placa}`;
        contenedor.appendChild(div);
      });
    }

    function limpiarPlacasYaExistentes() {
      let placasFaltantes = JSON.parse(localStorage.getItem('placasFaltantes') || '[]');
      placasFaltantes = placasFaltantes.filter(p =>
        !placas.includes(p) && !placasTemporales.includes(p)
      );
      localStorage.setItem('placasFaltantes', JSON.stringify(placasFaltantes));
    }

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }

    window.onload = function () {
      verificarAcceso();
      limpiarPlacasYaExistentes();
      mostrarChat();
    };

    document.getElementById('inputPlaca').addEventListener('input', function () {
      this.value = this.value.toUpperCase();
    });

    document.getElementById('placaFaltante').addEventListener('input', function () {
      this.value = this.value.toUpperCase();
    });
  </script>
</body>
</html>